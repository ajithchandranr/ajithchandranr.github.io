<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta content="width=device-width, initial-scale=1.0" name="viewport">
      <title>Home Lab for Live Attack Demonstrations in SIEM </title>
      <meta content="" name="description">
      <meta content="" name="keywords">
      <!-- Favicons -->
      <link href="../assets/img/favicon.png" rel="icon">
      <link href="../assets/img/apple-touch-icon.png" rel="apple-touch-icon">
      <!-- Google Fonts -->
      <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
      <!-- Vendor CSS Files -->
      <link href="../assets/vendor/aos/aos.css" rel="stylesheet">
      <link href="../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
      <link href="../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
      <link href="../assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
      <link href="../assets/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
      <link href="../assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">
      <!-- Template Main CSS File -->
      <link href="../assets/css/style.css" rel="stylesheet">
      <!-- =======================================================
         * Template Name: iPortfolio
         * Updated: Mar 10 2023 with Bootstrap v5.2.3
         * Template URL: https://bootstrapmade.com/iportfolio-bootstrap-portfolio-websites-template/
         * Author: BootstrapMade.com
         * License: https://bootstrapmade.com/license/
         ======================================================== -->
   </head>
   <body>
      <!-- ======= Mobile nav toggle button ======= --> <i class="bi bi-list mobile-nav-toggle d-xl-none"></i> <!-- ======= Header ======= -->
      <header id="header">
         <div class="d-flex flex-column">
            <div class="profile">
               <img src="../assets/img/profile-img.png" alt="" class="img-fluid rounded-circle">
               <h1 class="text-light"><a href="../index.html">Ajith Chandarn</a></h1>
               <div class="social-links mt-3 text-center"> <a href="https://github.com/ajithchandranr" class="github"><i class="bx bxl-github"></i></a> <a href="https://www.linkedin.com/in/ajithchandranr/" class="linkedin"><i class="bx bxl-linkedin"></i></a> <a href="https://twitter.com/ajith_kmr" class="twitter"><i class="bx bxl-twitter"></i></a> </div>
            </div>
         </div>
         <div class="nav-menu-wrapper">
            <nav id="navbar" class="nav-menu navbar">
               <ul>
                  <li><a href="../index.html#hero" class="nav-link scrollto"><i class="bx bx-home"></i> <span>Home</span></a></li>
                  <li><a href="../index.html#about" class="nav-link scrollto"><i class="bx bx-user"></i> <span>About</span></a></li>
                  <li><a href="../index.html#resume" class="nav-link scrollto"><i class="bx bx-file-blank"></i> <span>Resume</span></a></li>
                  <li><a href="../index.html#portfolio" class="nav-link scrollto active"><i class="bx bxs-edit-alt"></i> <span>My Projects</span></a></li>
                  <li><a href="../index.html#blog" class="nav-link scrollto"><i class="bx bxs-book-alt"></i> <span>Blog</span></a></li>
                  <li><a href="../index.html#contact" class="nav-link scrollto"><i class="bx bx-envelope"></i> <span>Contact</span></a></li>
               </ul>
            </nav>
            <!-- .nav-menu -->
         </div>
      </header>
      <!-- End Header -->
      <div class="social-links-container">
         <div class="social-links-2"> <a href="../index.html" class="home"><i class="bx bx-home"></i></a> <a href="https://github.com/ajithchandranr" class="github"><i class="bx bxl-github"></i></a> <a href="https://www.linkedin.com/in/ajithchandranr/" class="linkedin"><i class="bx bxl-linkedin"></i></a> <a href="https://twitter.com/ajith_kmr" class="twitter"><i class="bx bxl-twitter"></i></a> </div>
      </div>
      <main id="main">
         <!-- ======= Breadcrumbs ======= -->
         <section id="breadcrumbs" class="breadcrumbs">
            <div class="container">
               <div class="d-flex justify-content-between align-items-center">
                  <h2>Project Details</h2>
                  <ol>
                     <li><a href="../index.html">Home</a></li>
                     <li><a href="../index.html#portfolio">My Projects</a></li>
                  </ol>
               </div>
            </div>
         </section>
         <!-- End Breadcrumbs -->
         <!-- ======= Portfolio Details Section ======= -->
         <section id="portfolio-details" class="portfolio-details">
            <div class="container">
               <div class="portfolio-description" style="margin-bottom: 40px;">
                  <h2>Home Lab for Live Attack Demonstrations in SIEM (Microsoft Sentinel)</h2>
               </div>
               <div class="row gy-4">
                  <div class="col-lg-8">
                     <div class="portfolio-details-slider swiper">
                        <div class="swiper-wrapper align-items-center">
                           <div style="text-align: center;">
                              <figure style="display: inline-block;">
                                 <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_1.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_1.png " alt="Image 1" class="img-fluid"> </a>
                                 <figcaption style="font-size: 14px;" style="display: block;">Figure 1 - Network Diagram  </figcaption>
                              </figure>
                           </div>
                        </div>
                        <div class="swiper-pagination"></div>
                     </div>
                  </div>
                  <div class="col-lg-4">
                     <section class="portfolio-info">
                        <h3>Project information</h3>
                        <ul>
                           <li><strong>Title</strong>: Azure Sentinel Home Lab </li>
                           <li><strong>Organizer</strong>: Self</li>
                           <li><strong>Project date</strong>: July, 2023</li>
                           <li><strong>URL</strong>: <a href="ajithchandranr.github.io">ajithchandranr.github.io</a></li>
                        </ul>
                     </section>
                     <article class="project-container">
                        <div class="navigation">
                           <div class="half-column">
                              <div class="heading-button-container">
                                 <h4 class="project-heading">Active Directory Home Lab(Part 2)</h4>
                                 <a class="prev-button" href="home-lab-active-directory-part-2.html">Previous</a>
                              </div>
                           </div>
                           <div class="half-column">
                              <div class="heading-button-container">
                                 <h4 class="project-heading">Vulnerability Management Lab</h4>
                                 <a class="next-button" href="vulnerability-scanning-nessus-essentials.html">Next</a>
                              </div>
                           </div>
                        </div>
                     </article>
                  </div>
                  <div class="col-lg-8">
                     <h6 style="font-size: 17px; margin-bottom: 15px;">I would like to share my experience of using <b>"Microsoft Azure"</b> to create a virtual machine (VM) running <b><em>Windows 10</em></b> in the cloud. The main objective of this project was to demonstrate the integration of different tools and resources, such as <b>"Azure Log Analytics Workspace", Microsoft Defender for Cloud, and Azure Sentinel.</b></h6>
                  </div>
                  <div class="col-lg-8">
                     <h6 style="font-size: 17px; margin-bottom: 15px;">To start, I utilized PowerShell to scan the Event Viewer within the VM and specifically focused on <b>"EventID 4625",</b> which indicates failed logon attempts. I then captured this data and saved it in a log file. Additionally, I employed a PowerShell script to interact with the <b><em>www.abstractapi.com API,</b></em>  enabling me to retrieve IP addresses associated with these failed logon attempts. By utilizing these tools, I successfully collected and consolidated attack data, which I subsequently visualized on a map within <b>"Microsoft Sentinel".</b> This visualization allowed me to trace the origins of these logon attempts. </h6>
                  </div>
                  <div class="col-lg-8">
                     <h6 style="font-size: 17px;">Without any additional delay, let's begin. <i class='bx bx-run' style='color:#149ddd'> </i><i class='bx bx-run' style='color:#149ddd'> </i><i class='bx bx-run' style='color:#149ddd'> </i><i class='bx bx-run' style='color:#149ddd'></i> </h6>
                  </div>
               </div>
               <div class="col-lg-8" style="font-size: 30px; margin-bottom: 40px; margin-top: 20px; text-align: center; color: #149ddd;"> &nbsp;.&nbsp;.&nbsp;. </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">In this project, various tools and utilities were utilized, including <em><b>"Microsoft Sentinel (SIEM), Log Analytic Workbooks, Microsoft Defender for Cloud, Virtual Machines, Remote Desktop, PowerShell, APIs, Event Viewer, and Firewalls".</em></b> These resources were deployed in the <em><b>"Microsoft Azure" </em></b> cloud environment, with <br><em><b>"Windows 10(22H2)"</em></b>  as the operating system.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 18px; margin-bottom: 0px; font-weight: bold; margin-bottom: 15px;">Helpful Links:</h6>
               </div>
               <div class="col-lg-8 ;">
                  <ul>
                     <li>
                        <h6 style="font-size: 16px; margin-bottom: 15px; ">Microsoft Azure Free Trial: <a href="https://azure.microsoft.com/en-us/free/">https://azure.microsoft.com/en-us/free/</a></h6>
                     </li>
                     <li>
                        <h6 style="font-size: 16px;margin-bottom: 35px;">Geolocation API: <a href="https://www.abstractapi.com">https://www.abstractapi.com</a></h6>
                     </li>
                  </ul>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To get started, head over to the <b>"Microsoft Azure"</b> website and create a new account by clicking on the <b>"Start Free"</b> button. Complete the setup process, and once finished, you will be directed to the <b>"Microsoft Azure"</b> home page.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 25px;"><i class='bx bxs-bulb' style='color:#149ddd'></i> Upon signing up, Microsoft will grant you a $200 credit that remains valid for one month. Given that the resource requirements for this project are not particularly demanding, you can utilize the credit for future projects.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_2.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_2.png" alt="Image 1" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_3.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_3.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 2 & 3 — Creating Microsoft Azure Account and Azure homepage. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Next, navigate to the top menu and select<b> "Virtual Machine"</b> to create a publicly accessible VM, acting as a <em><b>honeypot</em></b> to attract potential attackers. Concurrently, establish a new Resource Group to streamline resource management and enable effortless creation, deletion, and organization of resources within a unified framework. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">I have designated the resource group as <em><b>"HoneyPot_Lab"</em></b> and named the virtual machine as <em><b>"HoneyPot-VM"</em></b>. Furthermore, I have opted for the <b>"(US) West US 3"</b> region, selected the <b>"Standard"</b> security type, and chosen <b>"Windows 10 Pro, Version 22H2"</b> as the operating system. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">As I continued scrolling down on the same page, I decided to choose the VM size and initially selected <b>"Standard_B1s"</b>. However, later on, I upgraded to <br><b>"Standard B2s"</b> for an improved user experience. I choose a unique admin name and a strong password with a mix of special characters, numbers, and lowercase and uppercase letters. For the public inbound port rules, I decide to allow only <b>"RDP (port 3389)"</b>" for connecting to the VM, </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_4.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_4.png" alt="Image 1" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_5.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_5.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 3 & 4 — Naming the virtual machine (VM) and selecting its size. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Next, we need to create a new <b>"Network Security Group (NSG)"</b> to serve as a firewall for the honeypot VM. In this project, our goal is to allow unrestricted communication with the VM by removing the default inbound rule and replacing it with a new rule that permits ALL traffic. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To achieve this, we set an asterisk <em><b>(*)</em></b> in the Destination Port Ranges field, enabling communication on any port ranges. Additionally, we have allowed any protocol for flexibility. The Priority has been set to <em><b>100</em></b>, giving this rule higher priority over others in case of conflicting rules. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;"><em><i class='bx bxs-bulb' style='color:#149ddd'></i>It's crucial to note that this configuration is intended for demonstration purposes only and should never be implemented in a real production environment.</em></h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_6.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_6.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_7.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_7.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_8.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_8.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 5, 6 & 7 — Network Interface Settings and adding an inbound rule. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Moving ahead, I navigated to the <b>"Review + Create"</b> section. After verifying the settings and configurations, I clicked on <b>"Create"</b> to deploy the virtual machine (VM).
                  </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_9.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_9.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_10.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_10.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 8 & 9 — Finalization of VM creation page and completion. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">I will create a Log Analytics Workspace to ingest logs from the virtual machine, including <b>"Windows event logs"</b>, and generate a custom log with <b>geographic information</b>. This helps to identify potential attackers' origins. <b>"Azure Sentinel"</b>, the <b>SIEM tool</b>, will connect to this workspace to display the geodata on a map for visualization and analysis.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To create a <b>Log Analytics Workspace,</b> you can locate it on the Azure home dashboard or by searching for it using the search bar. After selecting <b>"Create"</b>, I chose <b>"HoneyPot_Lab"</b> as the resource group and named the instance <br><em><b>"Law-Honeypot".</em></b> Finally, I clicked on <b>"Create"</b> to successfully deploy the workspace. </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_11.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_11.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_12.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_12.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_13.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_13.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 10, 11 & 12 — Creating a Log Analytics Workspace. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Next, we will proceed to <b>"Microsoft Defender for Cloud".</b> In the <b>"Environment Settings"</b> section, click on <b>"Defender Plans"</b> and activate only the plans for <em>Foundational CSPM and Servers</em>. Since there are no <em>SQL servers</em> in use, there is no need to enable that option. Be sure to save the settings after making these changes. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To connect Log Analytics to the VM, navigate to the <b>"Data Collection"</b> section on the left-hand side and select it. Choose the option to collect <b>"all events"</b> and save the settings accordingly. Once the changes are saved, Log Analytics will be successfully connected to the VM. </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_14.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_14.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_15.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_15.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_16.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_16.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 13, 14 & 15 — Configuring Microsoft Defender.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">I returned to the Log Analytics Workspace. There, I selected <b>"Law-Honeypot"</b> and chose <b>"Virtual Machines(deprecated)"</b>. From the list that appeared, I clicked on the virtual machine I had previously created. Finally, I established the connection between the Log Analytics Workspace and the virtual machine by clicking on <b>"Connect"</b>. </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_17.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_17.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_18.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_18.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 16 & 17 — Connecting the Log Analytics Workspace to the virtual machine. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Now, we will set up <b>Sentinel,</b> our <b>SIEM</b> tool, which will enable us to visualize the attack data. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">In the <b>Azure Sentinel interface</b>, click on<b> "Create Microsoft Sentinel"</b> to initiate the setup process. Create an Azure Sentinel <em>instance</em> and select the Log Analytics workspace (Law-Honeypot) for connection. Finally, click on <b>"add"</b> to establish the connection.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_19.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_19.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_20.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_20.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 18 & 19 — Adding Microsoft Sentinel to the Log Analytics Workspace. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Now that the Azure dashboard is all set up, I can proceed to configure my VM. To begin, I need to retrieve the "<b><em>public IP address"</b></em> of the VM so that I can establish a <b>Remote Desktop (RDP) connection</b>. In the Azure portal, I navigate to the Virtual Machines tab, locate the HoneyPot VM, and find the public IP address.</h6>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_21.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_21.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figure 20 — Virtual Machine overview.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Now, I have the ability to access my <b>VM</b> using <b>Remote Desktop</b>. To do so, I open the <b>Remote Desktop application</b> on my <em>native PC</em>. I enter the <b>VM's public IP address</b> and click on <b>"Connect"</b>. Then, I provide the necessary VM credentials and proceed to establish the connection.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_22.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_22.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_23.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_23.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_24.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_24.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 21, 22 & 23 — Accessing the virtual machine through Remote Desktop Protocol. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">After logging into the VM via RDP, I access the <b>Event Viewer's "Security"</b> section in <b>"Windows Logs."</b> It logs various Windows system activities with unique EventIDs. Our project focuses on <em><b>"EventID 4625",</em></b> indicating Failed Logon Attempts in the Security tab.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To demonstrate, I intentionally <em>initiate</em> another RDP session and enter an incorrect password during the VM login. The Event Viewer records this failed logon attempt, displaying details such as the <em>username, target machine, failure reason, and IP address</em> used. As more people find and use this setup, the Event Viewer gathers a variety of IP addresses, which enhances our data analysis.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_25.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_25.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_26.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_26.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 24 & 25 — Failing a logon and the subsequent entry in the Event Viewer. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">In my plan, I programmatically use <b>"PowerShell"</b> to extract the <b><em>IP address</b></em> from the <b>"Event Viewer".</b> Then, I utilize an <b><em>"IP geolocation API"</b></em> by sending the <b><em>IP address</b></em> as a request to <a href ="https://www.abstractapi.com">https://www.abstractapi.com</a>. The API provides valuable information such as the <em>country, state/province, city, latitude, and longitude</em> associated with the IP address. This data is used to create a custom log that I send to a <b>"Log Analytics workspace"</b> in <b>Azure</b>. Finally, I leverage <b>"Microsoft Sentinel"</b> to read the <em>latitude, longitude, or country information</em> and plot the attackers' locations on a map.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">As the next step, I attempt to <em><b>ping</em></b> the VM from my native computer to establish a direct connection and check its <em>discoverability</em>. However, I find that the VM is not discoverable. This is due to the <b>"Windows Defender Firewall"</b> being enabled on the VM. The firewall is blocking <em>ICMP Echo Requests</em>, which are necessary for successful pinging. I confirm this by pinging the VM's public IP address, <em><b>20.168.55.117</em></b>, and receiving <b>"Request timed out"</b> messages several times. The firewall is actively dropping the <em>ICMP</em> request packets.</h6>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_27.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_27.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 26 — Checking VMs discoverability.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To enable my VM to be "discoverable" on the internet, I accessed the <b>Windows Firewall</b> settings on the VM by searching for <em><b>"wf.msc"</em></b> in the Windows search bar. </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Then, I clicked on <b>"Windows Defender Firewall Properties"</b> and turned <b>"off"</b> the "<b>Firewall state"</b> for the "<em><b>Domain profile, Public profile, and Private profile"</b></em>. After applying the settings, I used the command prompt on my native computer to ping the VM once again. This time, the VM responded with replies as the firewall was no longer blocking ICMP requests. </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_28.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_28.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_29.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_29.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 27 & 28 — Modifying firewall rules and confirming discoverability. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;"><em><i class='bx bxs-bulb' style='color:#149ddd'></i> For testing purposes in the lab environment, I have temporarily disabled the firewall. However, it is important to note that disabling the firewall should never be done in a real-life production environment.</em> </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Now that my VM is accessible on the internet, I proceed to set up the essential <b>"PowerShell script"</b>. To do so, I visited the <a href="https://github.com/joshmadakor1/Sentinel-Lab/blob/main/Custom_Security_Log_Exporter.ps1"><i class='bx bxl-github' style='color:#149ddd'  ></i> GitHub page</a> of <em><u> "Josh Madakor,"</em></u> one of the mentors, and used his script as a reference for my work. After obtaining the script, I made modifications according to my requirements. Then, I opened <b>"PowerShell ISE"</b> and pasted the modified script into the editor. I save the script as a file named <b><em>"Log_Exporter"</b></em>. </h6>
               </div>
               <div class="col-lg-9" style="margin-bottom: 35px;">
                  <div class="vpn-instructions">
                     <pre>
            <code>
$API_KEY = "4dc70f7********************7d85d"
$LOGFILE_NAME = "failed_rdp.log"
$LOGFILE_PATH = "C:\ProgramData\$($LOGFILE_NAME)"
$THRESHOLD = 50
$TIME_FRAME_MINUTES = 5
$BLOCK_DURATION_MINUTES = 15

# Check if the execution policy is restricted
$executionPolicy = Get-ExecutionPolicy
if ($executionPolicy -eq "Restricted") {
    # Change the execution policy to RemoteSigned
    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser -Force
}

$BlockedIPs = @{}
$BlockedUntil = @{}  # Initialize as an empty hashtable

# Create the log file if it doesn't exist
if (-not (Test-Path -Path $LOGFILE_PATH)) {
    New-Item -ItemType File -Path $LOGFILE_PATH | Out-Null
}

$XMLFilter = @'
&lt;QueryList&gt; 
   &lt;Query Id="0" Path="Security"&gt;
         &lt;Select Path="Security"&gt;
              *&#91;System&#91;(EventID='4625')]]
          &lt;/Select&gt;
    &lt;/Query&gt;
&lt;/QueryList&gt; 
'@

while ($true) {
    Start-Sleep -Milliseconds 1000

    $events = Get-WinEvent -FilterXml $XMLFilter -MaxEvents 100 -ErrorAction SilentlyContinue

    foreach ($event in $events) {
        if ($event.properties[19].Value.Length -ge 5) {
            $timestamp = $event.TimeCreated.ToString("yyyy-MM-dd HH:mm:ss")
            $destinationHost = $event.MachineName
            $username = $event.properties[5].Value
            $sourceIp = $event.properties[19].Value

            $log_contents = Get-Content -Path $LOGFILE_PATH

            if (-not ($log_contents -match "$($timestamp)") -or ($log_contents.Length -eq 0)) {
                if ($BlockedUntil.ContainsKey($sourceIp) -and $BlockedUntil[$sourceIp] -gt (Get-Date)) {
                    Write-Host -BackgroundColor Black -ForegroundColor Red "IP $($sourceIp) is blocked. Skipping API call."
                    continue
                }

                Start-Sleep -Milliseconds 1000

                $API_ENDPOINT = "https://ipgeolocation.abstractapi.com/v1/?api_key=$($API_KEY)&ip_address=$($sourceIp)"
                $response = Invoke-RestMethod -Uri $API_ENDPOINT

                if (-not $response.error) {
                    $latitude = $response.latitude
                    $longitude = $response.longitude
                    $country = $response.country
                    $region = $response.region
                    $city = $response.city

                    $logEntry = "latitude:$($latitude),longitude:$($longitude),destinationhost:$($destinationHost),username:$($username),sourcehost:$($sourceIp),state:$($region),country:$($country),label:$($country) - $($sourceIp),timestamp:$($timestamp)"
                    Add-Content -Path $LOGFILE_PATH -Value $logEntry -Encoding utf8

                    Write-Host -BackgroundColor Black -ForegroundColor Yellow $logEntry
                    Write-Host ""  # Add a blank line

                    if ($BlockedIPs.ContainsKey($sourceIp)) {
                        $BlockedIPs[$sourceIp]++
                    } else {
                        $BlockedIPs[$sourceIp] = 1
                    }

                    if ($BlockedIPs[$sourceIp] -gt $THRESHOLD) {
                        $blockUntil = (Get-Date).AddMinutes($BLOCK_DURATION_MINUTES)
                        $BlockedUntil[$sourceIp] = $blockUntil
                        $blockUntilFormatted = $blockUntil.ToString("yyyy-MM-dd HH:mm:ss")
                        $blockMessage = "IP $($sourceIp) exceeded the threshold. Blocking until: $blockUntilFormatted"
                        Write-Host -BackgroundColor Black -ForegroundColor Red $blockMessage
                        Write-Host ""  # Add a blank line
                    }
                } else {
                    Write-Host -BackgroundColor Black -ForegroundColor Red "Error retrieving geolocation for IP $($sourceIp): $($response.error.message)"
                    Write-Host ""  # Add a blank line
                }
            }
        }
    }
}
          </code>
        </pre>
                  </div>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_30.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_30.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_32.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_32.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 29 & 30 — Opening Windows PowerShell ISE and saving the script. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     <h6 style="margin-bottom: 20px;">Please allow me to elaborate on some of the code utilized in this script.</h6>
                     <ul>
                        <li style="margin-bottom: 10px;">
                           <u><em>"$THRESHOLD"</u></em>: This variable sets the maximum number of failed RDP login attempts allowed from a single IP address. If the count of failed attempts exceeds this threshold, the IP address will be blocked to prevent further login attempts.
                        </li>
                        <li style="margin-bottom: 10px;">
                           <u><em>"$TIME_FRAME_MINUTES"</u></em>: This variable defines a time frame in minutes within which the script considers failed login attempts. Only failed attempts that occurred within this specified time frame will be counted towards the threshold. Failed attempts that are older than the specified time frame will not be considered.
                        </li>
                        <li style="margin-bottom: 10px;">
                           <u><em>"$BLOCK_DURATION_MINUTES"</u></em>: This variable represents the duration in minutes for which an IP address will be blocked if it exceeds the threshold of failed login attempts. Once an IP address surpasses the threshold, it will be blocked for the specified duration before the block is automatically lifted.
                        </li>
                        <li style="margin-bottom: 10px;">
                           <u><em>"$Get-WinEvent'"</u></em>: It is a PowerShell cmdlet used to retrieve security events from Windows event logs. In this script, 'Get-WinEvent' is specifically used to fetch events related to failed RDP (Remote Desktop Protocol) login attempts. By limiting the retrieval to 100 events at a time, the script can efficiently process multiple events without overwhelming system resources.
                        </li>
                     </ul>
                  </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;"><em><u>"This script monitors failed RDP login attempts and blocks IP addresses for 15 minutes if they exceed 50 attempts within a 5-minute timeframe, preventing brute-force attacks while also maintaining a limit on API calls to gather geolocation data and gain insights into attack diversities from different countries."</u></em> </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To utilize the script, I obtain my own API key from <em><u>www.abstractapi.com</u></em> and insert it into the designated location within the script. Afterward, I run the script to initiate its execution. The script continuously analyzes the event log, extracting failed logon events, and retrieves geolocation data for the corresponding, <em>IP addresses</em>. This data is then saved in the <em><b>"failed_rdp.log"</b></em> file located in the <em><b>"C:\ProgramData"</b></em> folder. </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_31.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_31.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_33.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_33.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 31 & 32 — Obtaining the Geolocation API Key and executing the script. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">The script is functioning correctly, saving data in the <b>"failed_rdp"</b> logfile as strings. The <em>PowerShell script</em> includes sample data, crucial for training AI models in <b><em>"Log Analytics Workbooks and Microsoft Sentinel"</em></b>, enhancing precision and accuracy. Later, I will use the logfile to map live attacks in <b>Microsoft Sentinel</b>.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">To acquire a sample data for training Log Analytics, I accessed the <b>"Log Analytics Workspace"</b> from the Microsoft Azure homepage. From there, I selected <b>"Law-Honeypot"</b> and clicked on <b>"Tables."</b> Next, I chose <b>"Create"</b> and selected <em><b>"New custom log (MMA-based)."</b></em> On the <b>"Create a custom log"</b> page, I was prompted to upload a sample log.</h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Returning to the VM, I navigated to <b>"C:\ProgramData"</b> and opened the <b><em>"failed_rdp"</em></b> log file. After copying a few lines from the log file, I saved the copied content on the <em>local machine</em> using a notepad application, naming it <em><b>"failed_rdp.log"</b></em>.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_35.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_35.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_36.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_36.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_37.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_37.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 33, 34 & 35 — Setting up a custom log in the Log Analytics Workspace. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">After selecting the <em><b>"failed_rdp.log"</b></em> file, I proceeded by clicking on <b>"next."</b> In the <b>"Record Delimiter"</b> section, I selected <b>"New line"</b> and verified the accuracy of the data and then clicked on <b>"next."</b></h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">In the <b>"Collection Path"</b> section, I selected the <b>type</b> as <em><b>"Windows"</b></em> and specified the <b>path</b> to the log file on the virtual machine as <b><em>"C:\ProgramData\failed_rdp.log"</b></em>. It is crucial to ensure the accuracy of this path because any errors in the path will prevent the successful collection of the log.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_38.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_38.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_39.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_39.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_40.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_40.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 36, 37 & 38 — Uploading the sample log, validating the details, and specifying the file path of the log on the VM. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">On the <b>"Details"</b> section, I entered <em><b>"Failed_RDP_With_Geo"</b></em> as the <b>"Custom log name"</b>. I proceed to finish the setup by clicking on <b>"Create"</b> in the <b>"Review + Create"</b> section.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_41.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_41.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_42.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_42.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 39 & 40 — Completing the process of setting up a custom log in the Log Analytics Workspace. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     I decided to <em>query</em> the <b>Event Viewer</b> and the newly created <b>"Failed_RDP_With_Geo"</b> custom log to check whether they are working as intended. To do that, on the <b>"Log Analytics Workspace,"</b> I selected <b>"Law-Honeypot"</b> and chose <b>"Logs."</b> Then, I entered the following two queries one after another and clicked on <b>"Run"</b>
                  </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;"><span class="highlighted">SecurityEvent<br>| where EventID == 4625</span></h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;"><span class="highlighted">Failed_RDP_With_Geo_CL</span></h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">After executing these queries, it is evident that logs are being displayed, confirming the synchronization and successful transmission of data between the <em><b>VM and Log Analytics.</b></em></h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_43.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_43.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                           <figure style="display: inline-block;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_44.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_44.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 41 & 42 — Querying 'SecurityEvent' table for EventID 4625 and 'Failed_RDP_With_Geo_CL' table. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">Next, I am extracting specific details from the <b>"raw data"</b> and verifying their correct categorization within the <b>"Log Analytic Workspace"</b>. I have used a <em>script</em> that extracts key fields from the <em><b>"Failed_RDP_With_Geo_CL"</b></em> dataset, including <em><b>username, timestamp, latitude, longitude, sourcehost, state, label, destination, and country</b></em>. The script filters out any entries with the destination labeled as <em><b>"samplehost"</b></em> and eliminates records with empty sourcehost values. Finally, the script summarizes the event count based on the extracted fields.
                  </h6>
               </div>
               <div class="col-lg-9" style="margin-bottom: 35px;">
                  <div class="vpn-instructions">
                     <pre>
            <code>
Failed_RDP_With_Geo_CL
| extend username = extract(@"username:([^,]+)", 1, RawData),
       timestamp = extract(@"timestamp:([^,]+)", 1, RawData),
       latitude = extract(@"latitude:([^,]+)", 1, RawData),
       longitude = extract(@"longitude:([^,]+)", 1, RawData),
       sourcehost = extract(@"sourcehost:([^,]+)", 1, RawData),
       state = extract(@"state:([^,]+)", 1, RawData),
       label = extract(@"label:([^,]+)", 1, RawData),
       destination = extract(@"destinationhost:([^,]+)", 1, RawData),
       country = extract(@"country:([^,]+)", 1, RawData)
|  where sourcehost != ""
|  summarize event_count = count() by timestamp, longitude, latitude, label, country, state, sourcehost, username, destination
          </code>
        </pre>
                  </div>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_46.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_46.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figure 43 — Running the script to extract key fields from the "Failed_RDP_With_Geo_CL" table.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">The next step in the process was to initiate the setup of a <b>"geomap"</b> in <b>Sentinel,</b> which would <em>visualize and plot the origins of the attacks or login attempts.</em></h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">I navigated to <b>"Azure Sentinel"</b> and select the <b>"Law-Honeypot"</b> option. In the <b>"overview"</b> section, I can observe incoming logs and specifically focus on the <em><b>"Failed RDP with Geolocation"</em></b> category, which provides a list of corresponding events. These events represent the <em><b>Security Event</em></b> logs that originate from the <b>virtual machine.</b></h6>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_45.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_45.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 44 — Microsoft Sentinel Overview.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">On the <b>"Workbooks"</b> section I created a new workbook using the <b>"Add Workbook"</b> option. Then I proceeded to click on <b>"Edit"</b> and removed the default widgets that were already present. Following that, I selected "<b>Add query"</b> to specify the dataset and fields from <b>Log Analytics</b> that I wanted <b>Microsoft Sentinel</b> to utilize. This allowed me to effectively query the desired data within the workbook.</h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_47.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_47.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_48.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_48.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_49.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_49.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 45, 46 & 47 — Creating a new workbook in Microsoft Sentinel. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     Afterward, I entered the query provided below and selected the <b>"Run Query"</b> option, which retrieved all the necessary information for plotting the <b>"Failed RDP World Map."</b>
                  </h6>
               </div>
               <div class="col-lg-9" style="margin-bottom: 35px;">
                  <div class="vpn-instructions">
                     <pre>
                            <code>
Failed_RDP_With_Geo_CL 
| extend username = extract(@"username:([^,]+)", 1, RawData),
         timestamp = extract(@"timestamp:([^,]+)", 1, RawData),
         latitude = extract(@"latitude:([^,]+)", 1, RawData),
         longitude = extract(@"longitude:([^,]+)", 1, RawData),
         sourcehost = extract(@"sourcehost:([^,]+)", 1, RawData),
         state = extract(@"state:([^,]+)", 1, RawData),
         label = extract(@"label:([^,]+)", 1, RawData),
         destination = extract(@"destinationhost:([^,]+)", 1, RawData),
         country = extract(@"country:([^,]+)", 1, RawData) 
| where sourcehost != ""
| summarize event_count=count() by latitude, longitude, sourcehost, label, destination, country
                          </code>
                        </pre>
                  </div>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_50.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_50.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 48 — Running the query to retrieve the necessary information for plotting the Map.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     I clicked on <b>"Visualization"</b> and selected <b>"Map"</b> from the drop-down menu. Moving on to the <b>"Map Settings"</b> section, I scrolled down to the <b>"Metric Settings"</b> where I chose <b>"label"</b> for the <b>"Metric label"</b> and <b>"event_count"</b>for the <b>"Metric Value."</b>
                  </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     Once done, I clicked on <b>"apply"</b> and then on <b>"Save and Close."</b> Finally, I saved the workbook under the name <b>"Failed RDP World Map."</b>
                  </h6>
               </div>
               <div style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_51.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_51.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block; margin-right: 5px;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_52.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_52.png" alt="Image 2" class="img-fluid"> </a> </figure>
                           <figure style="display: inline-block;"> <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_53.png"> <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_53.png" alt="Image 2" class="img-fluid"> </a> </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figures 49, 50 & 51 — Changing the visualization to a map, applying relevant Map settings, and saving the workbook. </figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 35px;">
                     Visualized data on the map.
                  </h6>
               </div>
               <div class="col-lg-8" style="margin-bottom: 35px;">
                  <div class="portfolio-details-slider swiper">
                     <div class="swiper-wrapper align-items-center">
                        <div style="text-align: center; display: flex;">
                           <figure style="display: inline-block; margin-right: 5px;">
                              <a href="javascript:;" class="zoom-icon" data-image="assets/home-lab-siem-microsoft-sentinel/hl-ms_54.png">
                              <img src="assets/home-lab-siem-microsoft-sentinel/hl-ms_54.png" alt="Image 2" class="img-fluid">
                              </a>
                           </figure>
                        </div>
                     </div>
                  </div>
                  <div style="text-align: center;">
                     <figcaption style="font-size: 14px;">Figure 52 — Visualized data on the map.</figcaption>
                  </div>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 20px;">
                     During the <b>"Home Lab for Live Attack Demonstrations in SIEM (Microsoft Sentinel)" project</b>, I gained practical experience in several crucial areas. This encompassed creating a virtual machine (VM) in Azure, configuring log collection using Log Analytics Workspace, working with APIs, and utilizing Azure Sentinel for SIEM purposes. I effectively utilized a PowerShell script to extract failed logon attempts, retrieve geolocation data, and visualize it on a map. 
                  </h6>
               </div>
               <div class="col-lg-8">
                  <h6 style="font-size: 17px; margin-bottom: 20px;">
                     Participating in this hands-on project was an enjoyable and immensely educational experience. This practical engagement greatly enhanced my skill set and provided me with a deeper understanding of the capabilities of Microsoft Sentinel and its pivotal role in bolstering cybersecurity measures.
                  </h6>
               </div>
               <div class="col-lg-8" style="font-size: 30px; margin-bottom: 40px; margin-top: 20px; text-align: center; color: #149ddd;"> &nbsp;.&nbsp;.&nbsp;. </div>
               <div class="col-lg-8">
                  <article class="custom-project-container" style="margin-bottom: 20px;">
                     <div class="custom-navigation">
                        <div class="custom-half-column">
                           <a href="home-lab-active-directory-part-2.html" class="custom-project-heading">
                           Active Directory Home Lab (Part 2) : Configuring Active Directory Services
                           </a>
                           <a class="custom-prev-button" href="home-lab-active-directory-part-2.html">Previous</a>
                        </div>
                        <div class="custom-half-column">
                           <a href="vulnerability-scanning-nessus-essentials.html" class="custom-project-heading">
                           Vulnerability Management Home Lab with Nessus Essentials
                           <a class="custom-next-button" href="vulnerability-scanning-nessus-essentials.html">Next</a>
                        </div>
                     </div>
                  </article>
               </div>
               <h6 style="font-size: 16px;">
                  Thank you for taking the time to read this. I can be reached on 
                  <div class="pill-tab-end"> <a href="https://www.twitter.com/ajith_kmr" class="pill-link-end"><i class="bx bxl-twitter"></i> twitter</a> </div>
                  <div class="pill-tab-end"> <a href="https://www.linkedin.com/in/ajithchandranr/" class="pill-link-end"><i class="bx bxl-linkedin"></i> LinkedIn</a> </div>
               </h6>
            </div>
            </div>
            </div>
         </section>
         <!-- End Portfolio Details Section -->
      </main>
      <!-- End #main -->
      <!-- ======= Footer ======= -->
      <footer id="footer">
         <div class="container">
            <div class="copyright"> By <strong><span>Ajith Chandran</span></strong> </div>
            <div class="credits"> Copyright © 2023 </div>
         </div>
      </footer>
      <!-- End  Footer --> <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a> <!-- Vendor JS Files -->
      <script src="../assets/vendor/purecounter/purecounter_vanilla.js"></script>
      <script src="../assets/vendor/aos/aos.js"></script>
      <script src="../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
      <script src="../assets/vendor/glightbox/js/glightbox.min.js"></script>
      <script src="../assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
      <script src="../assets/vendor/swiper/swiper-bundle.min.js"></script>
      <script src="../assets/vendor/typed.js/typed.min.js"></script>
      <script src="../assets/vendor/waypoints/noframework.waypoints.js"></script>
      <script src="../assets/vendor/php-email-form/validate.js"></script> <!-- Template Main JS File -->
      <script src="../assets/js/main.js"></script>
   </body>
</html>